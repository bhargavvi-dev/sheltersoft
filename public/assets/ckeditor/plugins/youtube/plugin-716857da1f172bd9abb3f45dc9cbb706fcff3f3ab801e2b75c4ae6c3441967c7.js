function ytVidId(t){var e=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;return t.match(e)?RegExp.$1:!1}function hmsToSeconds(t){for(var e=t.split(":"),l=0,u=1;e.length>0;)l+=u*parseInt(e.pop(),10),u*=60;return l}!function(){CKEDITOR.plugins.add("youtube",{lang:["en","pt","ja","hu","it","fr","tr","ru","de"],init:function(t){t.addCommand("youtube",new CKEDITOR.dialogCommand("youtube",{allowedContent:"iframe[!width,!height,!src,!frameborder,!allowfullscreen]; object param[*]"})),t.ui.addButton("Youtube",{label:t.lang.youtube.button,toolbar:"insert",command:"youtube",icon:this.path+"images/icon.png"}),CKEDITOR.dialog.add("youtube",function(e){var l;return{title:t.lang.youtube.title,minWidth:500,minHeight:200,contents:[{id:"youtubePlugin",expand:!0,elements:[{id:"txtEmbed",type:"textarea",label:t.lang.youtube.txtEmbed,autofocus:"autofocus",onKeyUp:function(t){this.getValue().length>0?this.getDialog().getContentElement("youtubePlugin","txtUrl").disable():this.getDialog().getContentElement("youtubePlugin","txtUrl").enable()},validate:function(){if(this.isEnabled()){if(!this.getValue())return alert(t.lang.youtube.noCode),!1;if(0===this.getValue().length||-1===this.getValue().indexOf("//"))return alert(t.lang.youtube.invalidEmbed),!1}}},{type:"html",html:t.lang.youtube.or+"<hr>"},{type:"hbox",widths:["70%","15%","15%"],children:[{id:"txtUrl",type:"text",label:t.lang.youtube.txtUrl,onKeyUp:function(t){this.getValue().length>0?this.getDialog().getContentElement("youtubePlugin","txtEmbed").disable():this.getDialog().getContentElement("youtubePlugin","txtEmbed").enable()},validate:function(){if(this.isEnabled()){if(!this.getValue())return alert(t.lang.youtube.noCode),!1;if(l=ytVidId(this.getValue()),0===this.getValue().length||l===!1)return alert(t.lang.youtube.invalidUrl),!1}}},{type:"text",id:"txtWidth",width:"60px",label:t.lang.youtube.txtWidth,"default":null!=t.config.youtube_width?t.config.youtube_width:"640",validate:function(){if(!this.getValue())return alert(t.lang.youtube.noWidth),!1;var e=parseInt(this.getValue())||0;return 0===e?(alert(t.lang.youtube.invalidWidth),!1):void 0}},{type:"text",id:"txtHeight",width:"60px",label:t.lang.youtube.txtHeight,"default":null!=t.config.youtube_height?t.config.youtube_height:"360",validate:function(){if(!this.getValue())return alert(t.lang.youtube.noHeight),!1;var e=parseInt(this.getValue())||0;return 0===e?(alert(t.lang.youtube.invalidHeight),!1):void 0}}]},{type:"hbox",widths:["55%","45%"],children:[{id:"chkRelated",type:"checkbox","default":null!=t.config.youtube_related?t.config.youtube_related:!0,label:t.lang.youtube.chkRelated},{id:"chkOlderCode",type:"checkbox","default":null!=t.config.youtube_older?t.config.youtube_older:!1,label:t.lang.youtube.chkOlderCode}]},{type:"hbox",widths:["55%","45%"],children:[{id:"chkPrivacy",type:"checkbox",label:t.lang.youtube.chkPrivacy,"default":null!=t.config.youtube_privacy?t.config.youtube_privacy:!1},{id:"txtStartAt",type:"text",label:t.lang.youtube.txtStartAt,validate:function(){if(this.getValue()){var e=this.getValue();if(!/^(?:(?:([01]?\d|2[0-3]):)?([0-5]?\d):)?([0-5]?\d)$/i.test(e))return alert(t.lang.youtube.invalidTime),!1}}}]}]}],onOk:function(){var t="";if(this.getContentElement("youtubePlugin","txtEmbed").isEnabled())t=this.getValueOf("youtubePlugin","txtEmbed");else{var e,u="//",a=[],i=this.getValueOf("youtubePlugin","txtWidth"),n=this.getValueOf("youtubePlugin","txtHeight");if(u+=this.getContentElement("youtubePlugin","chkPrivacy").getValue()===!0?"www.youtube-nocookie.com/":"www.youtube.com/",u+="embed/"+l,this.getContentElement("youtubePlugin","chkRelated").getValue()===!1&&a.push("rel=0"),e=this.getValueOf("youtubePlugin","txtStartAt")){var o=hmsToSeconds(e);a.push("start="+o)}this.getContentElement("youtubePlugin","chkOlderCode").getValue()===!0?(u=u.replace("embed/","v/"),u=u.replace(/&/g,"&amp;"),0==a.length&&(u+="?"),u+="hl=pt_BR&amp;version=3",t='<object width="'+i+'" height="'+n+'">',t+='<param name="movie" value="'+u+'"></param>',t+='<param name="allowFullScreen" value="true"></param>',t+='<param name="allowscriptaccess" value="always"></param>',t+='<embed src="'+u+'" type="application/x-shockwave-flash" ',t+='width="'+i+'" height="'+n+'" allowscriptaccess="always" ',t+='allowfullscreen="true"></embed>',t+="</object>"):(a.length>0&&(u=u+"?"+a.join("&")),t='<iframe width="'+i+'" height="'+n+'" src="'+u+'" ',t+='frameborder="0" allowfullscreen></iframe>')}var r=this.getParentEditor();r.insertHtml(t)}}})}})}();