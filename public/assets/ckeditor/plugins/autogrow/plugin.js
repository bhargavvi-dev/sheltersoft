/**
 * @license Copyright (c) 2003-2013, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or http://ckeditor.com/license
 */
!function(){function e(e){var t=e.getStyle("overflow-y"),o=e.getDocument(),n=CKEDITOR.dom.element.createFromHtml('<span style="margin:0;padding:0;border:0;clear:both;width:1px;height:1px;display:block;">'+(CKEDITOR.env.webkit?"&nbsp;":"")+"</span>",o);o[CKEDITOR.env.ie?"getBody":"getDocumentElement"]().append(n);var i=n.getDocumentPosition(o).y+n.$.offsetHeight;return n.remove(),e.setStyle("overflow-y",t),i}function t(e){var t=e.document,o=t.getBody(),n=t.getDocumentElement();return"BackCompat"==t.$.compatMode?o:n}var o=function(o,n){if(!o.window)return null;var i=o.getCommand("maximize");if(i&&i.state==CKEDITOR.TRISTATE_ON)return null;var a=t(o),r=o.window.getViewPaneSize().height,m=e(a);m+=o.config.autoGrow_bottomSpace||0;var d=void 0!=o.config.autoGrow_minHeight?o.config.autoGrow_minHeight:200,c=o.config.autoGrow_maxHeight||1/0;return m=Math.max(m,d),m=Math.min(m,c),m!=r&&n!=m&&(m=o.fire("autoGrow",{currentHeight:r,newHeight:m}).newHeight,o.resize(o.container.getStyle("width"),m,!0),n=m),a.$.scrollHeight>a.$.clientHeight&&c>m?a.setStyle("overflow-y","hidden"):a.removeStyle("overflow-y"),n};CKEDITOR.plugins.add("autogrow",{init:function(e){e.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&e.on("instanceReady",function(){var n,i=e.editable();if(i.isInline())e.ui.space("contents").setStyle("height","auto");else{e.addCommand("autogrow",{exec:function(e){n=o(e,n)},modes:{wysiwyg:1},readOnly:1,canUndo:!1,editorFocus:!1});var a={contentDom:1,key:1,selectionChange:1,insertElement:1,mode:1};for(var r in a)e.on(r,function(e){"wysiwyg"==e.editor.mode&&setTimeout(function(){n=o(e.editor,n),n=o(e.editor,n)},100)});e.on("afterCommandExec",function(i){if("maximize"==i.data.name&&"wysiwyg"==i.editor.mode)if(i.data.command.state==CKEDITOR.TRISTATE_ON){var a=t(e);a.removeStyle("overflow")}else n=o(e,n)}),e.config.autoGrow_onStartup&&e.execCommand("autogrow")}})}})}();